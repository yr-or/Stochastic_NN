"""
For verifying the ouputs of the synthesised and implemented stochastic moudles in Vrilog
"""

def bipolar_to_prob(y):
    return (y+1)/2

def bipolar_to_prob_int(y):
    return int(bipolar_to_prob(y)*256)

def bipolar_to_prob_int10(y):
    return int(bipolar_to_prob(y)*4096)

def prob_to_bipolar(x):
    return (2*x)-1

def prob_int_to_bipolar(x):
    return prob_to_bipolar(x/256)

def prob_int16_to_bipolar(x):
    return prob_to_bipolar(x/65536)

def prob_int12_to_bipolar(x):
    return prob_to_bipolar(x/4096)

def prob_int16_to_unipolar(x):
    return x/65536



# Python output using scaled add, ReLU function
L2_bias_out_pyt_float = [4.947185516357422e-05, -0.0027446746826171875, -0.001840353012084961, -0.00021970272064208984, 0.0019184350967407227, 0.0025833845138549805, 0.004719853401184082, 0.0016952753067016602, 0.005514621734619141, -0.006518363952636719, 0.0013564825057983398, 0.0011587142944335938, -0.00042951107025146484, 0.0020524263381958008, 0.0064629316329956055, 0.0034962892532348633, 0.0017713308334350586, -0.00323486328125, -0.0016418695449829102, 0.002988457679748535, 0.0005317926406860352, 0.0028287172317504883, 0.0019246339797973633, -0.003946900367736816, 0.001986384391784668, 0.0010368824005126953, 0.0059413909912109375, -0.0007575750350952148, -0.00026798248291015625, -0.0001327991485595703, 0.002078413963317871, -0.0005162954330444336]
L2_macc_out_pyt_float = [-0.00023674964904785156, -0.005519866943359375, -0.003680706024169922, -0.0007140636444091797, 0.0034401416778564453, 0.004800558090209961, 0.009500741958618164, 0.0033600330352783203, 0.010937690734863281, -0.013616561889648438, 0.0029265880584716797, 0.0019512176513671875, -0.0009810924530029297, 0.0035860538482666016, 0.012040853500366211, 0.0058634281158447266, 0.003695249557495117, -0.007080078125, -0.0031311511993408203, 0.00551915168762207, 0.0005753040313720703, 0.0053217411041259766, 0.0034525394439697266, -0.008504152297973633, 0.003789663314819336, 0.0012803077697753906, 0.012462615966796875, -0.0013015270233154297, -0.0019092559814453125, -0.00014352798461914062, 0.004645109176635742, -0.0011851787567138672]

# Vivado chipscope macc outputs, scaled by 256
L2_N0_macc_out_int16 = 32978
L2_N0_bias_out_int16 = 16481

# Compare
print( prob_int16_to_bipolar(L2_N0_macc_out_int16) )
print( prob_int16_to_bipolar(L2_N0_bias_out_int16) )